<%= code_editor "##{addon[:id]} .html", mode: :html %>

<dl class="see mod-guide-procedure">
  <dt><%= @model.t :html %><%= @model.tt :html %></dt>
  <dd><%= f.text_area :html, class: :html %></dd>

  <dt><%= @model.t :procedure_location %><%= @model.tt :procedure_location %></dt>
  <dd><%= f.text_area :procedure_location %></dd>

  <dt><%= @model.t :belongings %><%= @model.tt :belongings %></dt>
  <dd><%= f.ss_lines_field :belongings %></dd>

  <dt><%= @model.t :procedure_applicant %><%= @model.tt :procedure_applicant %></dt>
  <dd><%= f.ss_lines_field :procedure_applicant %></dd>

  <dt><%= @model.t :remarks %><%= @model.tt :remarks %></dt>
  <dd><%= f.text_area :remarks %></dd>
</dl>

<dl class="see mod-guide-procedure" style="margin-top: 10px;">
  <dt><%= @model.t :cond_yes_edge_values %><%= @model.tt :cond_yes_edge_values %></dt>
  <dd>
    <%= hidden_field_tag "item[cond_yes_edge_values][][question_id]", '', id: nil, class: "hidden-ids" %>
    <%= hidden_field_tag "item[cond_yes_edge_values][][edge_value]", '', id: nil, class: "hidden-ids" %>
    <%= hidden_field_tag "item[cond_yes_question_ids][]", '', id: nil, class: "hidden-ids" %>
    <%= link_to t("ss.links.select"), guide2_apis_questions_path(nid: @cur_node.id, id: @item.id), class: "ajax-box", data: { template: "#{addon[:id]}-template-y" } %>
  </dd>
  <dd>
    <table class="index ajax-selected">
      <thead>
        <tr>
          <th class="name"><%= @model.t :name %></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @item.cond_yes_questions.each do |question| %>
          <% question.edges.in(value: @item.cond_yes_edge_values.select { |v| v[:question_id].to_s == question.id.to_s }.collect { |v| v[:edge_value] }).each do |edge| %>
            <tr data-id="<%= question.id %>:<%= edge.id %>">
              <td>
                <%= hidden_field_tag "item[cond_yes_edge_values][][question_id]", question.id, id: nil %>
                <%= hidden_field_tag "item[cond_yes_edge_values][][edge_value]", edge.value, id: nil %>
                <%= hidden_field_tag "item[cond_yes_question_ids][]", question.id, id: nil %>
                <%= question.name %><%= edge.value %>
              </td>
              <td><%= link_to t("ss.buttons.delete"), "#", class: "deselect btn" %></td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>

    <%= tag.script id: "#{addon[:id]}-template-y", type: "text/ejs" do %>
      <tr data-id="<%= ejs_template("data.id") %>">
        <td>
          <%= hidden_field_tag "item[cond_yes_edge_values][][question_id]", ejs_template("data.questionId"), id: nil %>
          <%= hidden_field_tag "item[cond_yes_edge_values][][edge_value]", ejs_template("data.edgeValue"), id: nil %>
          <%= hidden_field_tag "item[cond_yes_question_ids][]", ejs_template("data.questionId"), id: nil %>
          <%= ejs_template("data.name") %>
        </td>
        <td><%= link_to t("ss.buttons.delete"), "#", class: "deselect btn" %></td>
      </tr>
    <% end %>
  </dd>
</dl>

<dl class="see mod-guide-procedure" style="margin-top: 10px;">
  <dt><%= @model.t :cond_no_edge_values %><%= @model.tt :cond_no_edge_values %></dt>
  <dd>
    <%= hidden_field_tag "item[cond_no_edge_values][][question_id]", '', id: nil, class: "hidden-ids" %>
    <%= hidden_field_tag "item[cond_no_edge_values][][edge_value]", '', id: nil, class: "hidden-ids" %>
    <%= hidden_field_tag "item[cond_no_question_ids][]", '', id: nil, class: "hidden-ids" %>
    <%= link_to t("ss.links.select"), guide2_apis_questions_path(nid: @cur_node.id, id: @item.id), class: "ajax-box", data: { template: "#{addon[:id]}-template-n" } %>
  </dd>
  <dd>
    <table class="index ajax-selected">
      <thead>
        <tr>
          <th class="name"><%= @model.t :name %></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @item.cond_no_questions.each do |question| %>
          <% question.edges.in(value: @item.cond_no_edge_values.select { |v| v[:question_id].to_s == question.id.to_s }.collect { |v| v[:edge_value] }).each do |edge| %>
            <tr data-id="<%= question.id %>:<%= edge.id %>">
              <td>
                <%= hidden_field_tag "item[cond_no_edge_values][][question_id]", question.id, id: nil %>
                <%= hidden_field_tag "item[cond_ncond_no_edge_valueso_edge_names][][edge_value]", edge.value, id: nil %>
                <%= hidden_field_tag "item[cond_no_question_ids][]", question.id, id: nil %>
                <%= question.name %><%= edge.value %>
              </td>
              <td><%= link_to t("ss.buttons.delete"), "#", class: "deselect btn" %></td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>

    <%= tag.script id: "#{addon[:id]}-template-n", type: "text/ejs" do %>
      <tr data-id="<%= ejs_template("data.id") %>">
        <td>
          <%= hidden_field_tag "item[cond_no_edge_values][][question_id]", ejs_template("data.questionId"), id: nil %>
          <%= hidden_field_tag "item[cond_no_edge_values][][edge_value]", ejs_template("data.edgeValue"), id: nil %>
          <%= hidden_field_tag "item[cond_no_question_ids][]", ejs_template("data.questionId"), id: nil %>
          <%= ejs_template("data.name") %>
        </td>
        <td><%= link_to t("ss.buttons.delete"), "#", class: "deselect btn" %></td>
      </tr>
    <% end %>
  </dd>
</dl>

<dl class="see mod-guide-procedure" style="margin-top: 10px;">
  <dt><%= @model.t :cond_or_edge_values %><%= @model.tt :cond_or_edge_values %></dt>
  <dd>
    <%= hidden_field_tag "item[cond_or_edge_values][][question_id]", '', id: nil, class: "hidden-ids" %>
    <%= hidden_field_tag "item[cond_or_edge_values][][edge_value]", '', id: nil, class: "hidden-ids" %>
    <%= hidden_field_tag "item[cond_or_question_ids][]", '', id: nil, class: "hidden-ids" %>
    <%= link_to t("ss.links.select"), guide2_apis_questions_path(nid: @cur_node.id, id: @item.id), class: "ajax-box", data: { template: "#{addon[:id]}-template-o" } %>
  </dd>
  <dd>
    <table class="index ajax-selected">
      <thead>
        <tr>
          <th class="name"><%= @model.t :name %></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @item.cond_or_questions.each do |question| %>
          <% question.edges.in(value: @item.cond_or_edge_values.select { |v| v[:question_id].to_s == question.id.to_s }.collect { |v| v[:edge_value] }).each do |edge| %>
            <tr data-id="<%= question.id %>:<%= edge.id %>">
              <td>
                <%= hidden_field_tag "item[cond_or_edge_values][][question_id]", question.id, id: nil %>
                <%= hidden_field_tag "item[cond_or_edge_values][][edge_value]", edge.value, id: nil %>
                <%= hidden_field_tag "item[cond_or_question_ids][]", question.id, id: nil %>
                <%= question.name %><%= edge.value %>
              </td>
              <td><%= link_to t("ss.buttons.delete"), "#", class: "deselect btn" %></td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>

    <%= tag.script id: "#{addon[:id]}-template-o", type: "text/ejs" do %>
      <tr data-id="<%= ejs_template("data.id") %>">
        <td>
          <%= hidden_field_tag "item[cond_or_edge_values][][question_id]", ejs_template("data.questionId"), id: nil %>
          <%= hidden_field_tag "item[cond_or_edge_values][][edge_value]", ejs_template("data.edgeValue"), id: nil %>
          <%= hidden_field_tag "item[cond_or_question_ids][]", ejs_template("data.questionId"), id: nil %>
          <%= ejs_template("data.name") %>
        </td>
        <td><%= link_to t("ss.buttons.delete"), "#", class: "deselect btn" %></td>
      </tr>
    <% end %>
  </dd>
</dl>
